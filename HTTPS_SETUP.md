# HTTPS Setup for Local Development

Modern browsers require HTTPS to access the camera API. This guide will help you set up HTTPS for local development.

## Quick Setup (Recommended)

Next.js 13.5+ has built-in HTTPS support. Simply run:

```bash
npm run dev:https
```

On first run, Next.js will:

1. Automatically install `mkcert` if needed
2. Generate SSL certificates
3. Set up local certificate authority
4. Start the server on `https://localhost:3000`

**Note**: You may be prompted for your password to install the certificate authority.

## Manual Setup (if automatic doesn't work)

If the automatic setup doesn't work, you can manually set up mkcert:

### 1. Install mkcert

**macOS:**

```bash
brew install mkcert
```

**Linux (Ubuntu/Debian):**

```bash
sudo apt install libnss3-tools
# Then download mkcert from https://github.com/FiloSottile/mkcert/releases
```

**Windows:**
Download from https://github.com/FiloSottile/mkcert/releases or use:

```powershell
choco install mkcert
```

### 2. Install the local CA

```bash
mkcert -install
```

This installs a local certificate authority that your browser will trust.

### 3. Run Next.js with HTTPS

```bash
npm run dev:https
```

Or manually:

```bash
next dev --experimental-https
```

### 4. Access your app

Open your browser and navigate to:

```
https://localhost:3000
```

**Important**: Make sure to use `https://` not `http://`

## Troubleshooting

### Certificate errors in browser

If you see certificate errors:

1. Make sure you're using `https://localhost:3000` (not `http://`)
2. Try clearing your browser cache
3. Make sure mkcert CA is installed: `mkcert -install`

### Camera still not working

1. **Check browser permissions**: Make sure you've allowed camera access
2. **Use HTTPS**: Camera API only works over HTTPS
3. **Check browser console**: Look for any error messages
4. **Try different browser**: Some browsers have stricter security policies

### Port already in use

If port 3000 is already in use:

```bash
# Use a different port
next dev --experimental-https -p 3001
```

Then access at `https://localhost:3001`

### iPad/iPhone access

To access from your iPad on the same network:

1. Find your computer's local IP address:

   - **macOS/Linux**: `ifconfig | grep "inet "`
   - **Windows**: `ipconfig`

2. Update Next.js to listen on all interfaces:

   ```bash
   next dev --experimental-https -H 0.0.0.0
   ```

3. Access from iPad:

   ```
   https://YOUR_IP_ADDRESS:3000
   ```

   **Note**: You'll need to accept the certificate warning on your iPad since it's a local certificate.

### Firefox issues

If using Firefox, you may need to install NSS tools:

```bash
brew install nss  # macOS
```

Then run `mkcert -install` again.

## Alternative: Using a tunneling service

If you want to avoid local HTTPS setup, you can use a tunneling service:

1. **ngrok** (recommended):

   ```bash
   # Install ngrok
   brew install ngrok  # or download from ngrok.com

   # Start your app normally
   npm run dev

   # In another terminal, create tunnel
   ngrok http 3000
   ```

   ngrok will give you an HTTPS URL you can use.

2. **Cloudflare Tunnel** (free):
   ```bash
   cloudflared tunnel --url http://localhost:3000
   ```

## Security Note

The certificates generated by mkcert are only valid for localhost and are trusted by your local machine. They should **never** be used in production or committed to version control.
